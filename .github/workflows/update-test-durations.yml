name: Update test durations

on:
  schedule:
    # trigger on the 5th of each month at 4 AM UTC
    - cron: 0 4 5 * *
  workflow_dispatch:
    inputs:
      publish-method:
        description: "Method to publish the test duration update results"
        type: choice
        options:
          - UPLOAD_ARTIFACT
          - CREATE_PR
        default: UPLOAD_ARTIFACT

jobs:
  update-test-durations:
    uses: localstack/meta/.github/workflows/update-test-durations.yml@main
    with:
      repository-name: localstack
      test-durations-file-path: .test_durations
      publish-method: ${{ inputs.publish-method || 'CREATE_PR' }}
    secrets:
      gh-token: ${{ secrets.GITHUB_TOKEN }}
      pr-token: ${{ secrets.PRO_ACCESS_TOKEN }}
