Parameters:
  AddBucket:
    Type: String
    AllowedValues:
      - "true"
      - "false"

  BucketName:
    Type: String

  IsFifo:
    Type: String
    AllowedValues:
      - "true"
      - "false"

Conditions:
  ShouldDeployBucket: !Equals ["true", !Ref AddBucket]
  SetIsFifo: !Equals ["true", !Ref IsFifo]

Resources:
  Queue:
    Type: AWS::SQS::Queue
    Properties:
      FifoQueue:
        !If [SetIsFifo, true, !Ref AWS::NoValue]

  Bucket:
    Type: AWS::S3::Bucket
    Condition: ShouldDeployBucket
    Properties:
      BucketName: !Ref BucketName

Outputs:
  QueueUrl:
    Value: !Ref Queue

  QueueArn:
    Value: !GetAtt Queue.Arn
