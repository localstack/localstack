{
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_dynamodb_event_source_mapping": {
    "recorded-date": "05-09-2022, 11:16:26",
    "recorded-content": {
      "create-table-result": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "my_partition_key",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "my_partition_key",
              "KeyType": "HASH"
            }
          ],
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:1>",
          "TableSizeBytes": 0,
          "TableStatus": "CREATING"
        }
      },
      "create_event_source_mapping_response": {
        "BatchSize": 1,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>",
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": 1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "event_logs": [
        {
          "Records": [
            {
              "eventID": "<event-i-d:1>",
              "eventName": "INSERT",
              "eventVersion": "1.1",
              "eventSource": "aws:dynamodb",
              "awsRegion": "<region>",
              "dynamodb": {
                "ApproximateCreationDateTime": "<approximate-creation-datetime>",
                "Keys": {
                  "my_partition_key": {
                    "S": "hello world"
                  }
                },
                "NewImage": {
                  "my_partition_key": {
                    "S": "hello world"
                  }
                },
                "SequenceNumber": "<sequence-number:1>",
                "SizeBytes": 54,
                "StreamViewType": "NEW_IMAGE"
              },
              "eventSourceARN": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>"
            }
          ]
        }
      ]
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_disabled_dynamodb_event_source_mapping": {
    "recorded-date": "05-09-2022, 11:17:35",
    "recorded-content": {
      "dynamodb_create_table_result": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "id",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "id",
              "KeyType": "HASH"
            }
          ],
          "LatestStreamArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
          "LatestStreamLabel": "<resource:1>",
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "StreamSpecification": {
            "StreamEnabled": true,
            "StreamViewType": "NEW_IMAGE"
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:2>",
          "TableSizeBytes": 0,
          "TableStatus": "CREATING"
        }
      },
      "create_event_source_mapping_result": {
        "BatchSize": 100,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": -1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "update_event_source_mapping_result": {
        "BatchSize": 100,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "OK",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": -1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Disabling",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      }
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_deletion_event_source_mapping_with_dynamodb": {
    "recorded-date": "05-09-2022, 11:18:03",
    "recorded-content": {
      "create_dynamodb_table_response": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "id",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "id",
              "KeyType": "HASH"
            }
          ],
          "LatestStreamArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
          "LatestStreamLabel": "<resource:1>",
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "StreamSpecification": {
            "StreamEnabled": true,
            "StreamViewType": "NEW_IMAGE"
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:2>",
          "TableSizeBytes": 0,
          "TableStatus": "CREATING"
        }
      },
      "create_event_source_mapping_result": {
        "BatchSize": 100,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 0,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": -1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "list_event_source_mapping_result": {
        "EventSourceMappings": [
          {
            "BatchSize": 100,
            "BisectBatchOnFunctionError": false,
            "DestinationConfig": {
              "OnFailure": {}
            },
            "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
            "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
            "FunctionResponseTypes": [],
            "LastModified": "datetime",
            "LastProcessingResult": "No records processed",
            "MaximumBatchingWindowInSeconds": 0,
            "MaximumRecordAgeInSeconds": -1,
            "MaximumRetryAttempts": -1,
            "ParallelizationFactor": 1,
            "StartingPosition": "TRIM_HORIZON",
            "State": "Enabled",
            "StateTransitionReason": "User action",
            "TumblingWindowInSeconds": 0,
            "UUID": "<uuid:2>"
          }
        ],
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        }
      }
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_dynamodb_event_source_mapping_with_on_failure_destination_config": {
    "recorded-date": "05-09-2022, 14:48:19",
    "recorded-content": {
      "update_table_response": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "my_partition_key",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST",
            "LastUpdateToPayPerRequestDateTime": "datetime"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "my_partition_key",
              "KeyType": "HASH"
            }
          ],
          "LatestStreamArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
          "LatestStreamLabel": "<resource:1>",
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "StreamSpecification": {
            "StreamEnabled": true,
            "StreamViewType": "NEW_IMAGE"
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:2>",
          "TableSizeBytes": 0,
          "TableStatus": "UPDATING"
        }
      },
      "create_event_source_mapping_response": {
        "BatchSize": 1,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {
            "Destination": "arn:aws:sqs:<region>:111111111111:<resource:3>"
          }
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:4>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": 1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "destination_queue_messages": {
        "Messages": [
          {
            "Body": {
              "requestContext": {
                "requestId": "<uuid:3>",
                "functionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:4>",
                "condition": "RetryAttemptsExhausted",
                "approximateInvokeCount": 2
              },
              "responseContext": {
                "statusCode": 200,
                "executedVersion": "$LATEST",
                "functionError": "Unhandled"
              },
              "version": "1.0",
              "timestamp": "date",
              "DDBStreamBatchInfo": {
                "shardId": "<shard-id:1>",
                "startSequenceNumber": "<start-sequence-number:1>",
                "endSequenceNumber": "<start-sequence-number:1>",
                "approximateArrivalOfFirstRecord": "date",
                "approximateArrivalOfLastRecord": "date",
                "batchSize": 1,
                "streamArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>"
              }
            },
            "MD5OfBody": "<m-d5-of-body:1>",
            "MessageId": "<uuid:4>",
            "ReceiptHandle": "<receipt-handle:1>"
          }
        ],
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        }
      }
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_dynamodb_event_filter[item_to_put10-None-filter0-1]": {
    "recorded-date": "05-09-2022, 15:50:30",
    "recorded-content": {
      "table_creation_response": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "id",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "id",
              "KeyType": "HASH"
            }
          ],
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:1>",
          "TableSizeBytes": 0,
          "TableStatus": "CREATING"
        }
      },
      "create_event_source_mapping_response": {
        "BatchSize": 1,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>",
        "FilterCriteria": {
          "Filters": [
            {
              "Pattern": {
                "eventName": [
                  "INSERT"
                ]
              }
            }
          ]
        },
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": 1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "lambda-log-events": [
        {
          "Records": [
            {
              "eventID": "<event-i-d:1>",
              "eventName": "INSERT",
              "eventVersion": "1.1",
              "eventSource": "aws:dynamodb",
              "awsRegion": "<region>",
              "dynamodb": {
                "ApproximateCreationDateTime": "<approximate-creation-datetime>",
                "Keys": {
                  "id": {
                    "S": "test123"
                  }
                },
                "NewImage": {
                  "id2": {
                    "S": "test42"
                  },
                  "id": {
                    "S": "test123"
                  }
                },
                "SequenceNumber": "<sequence-number:1>",
                "SizeBytes": 27,
                "StreamViewType": "NEW_AND_OLD_IMAGES"
              },
              "eventSourceARN": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>"
            }
          ]
        }
      ],
      "lambda-multiple-log-events": [
        {
          "Records": [
            {
              "eventID": "<event-i-d:1>",
              "eventName": "INSERT",
              "eventVersion": "1.1",
              "eventSource": "aws:dynamodb",
              "awsRegion": "<region>",
              "dynamodb": {
                "ApproximateCreationDateTime": "<approximate-creation-datetime>",
                "Keys": {
                  "id": {
                    "S": "test123"
                  }
                },
                "NewImage": {
                  "id2": {
                    "S": "test42"
                  },
                  "id": {
                    "S": "test123"
                  }
                },
                "SequenceNumber": "<sequence-number:1>",
                "SizeBytes": 27,
                "StreamViewType": "NEW_AND_OLD_IMAGES"
              },
              "eventSourceARN": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>"
            }
          ]
        }
      ]
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_dynamodb_event_filter[item_to_put11-item_to_put21-filter1-2]": {
    "recorded-date": "05-09-2022, 15:51:35",
    "recorded-content": {
      "table_creation_response": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "id",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "id",
              "KeyType": "HASH"
            }
          ],
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:1>",
          "TableSizeBytes": 0,
          "TableStatus": "CREATING"
        }
      },
      "create_event_source_mapping_response": {
        "BatchSize": 1,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>",
        "FilterCriteria": {
          "Filters": [
            {
              "Pattern": {
                "eventName": [
                  "INSERT",
                  "MODIFY"
                ]
              }
            }
          ]
        },
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": 1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "lambda-log-events": [
        {
          "Records": [
            {
              "eventID": "<event-i-d:1>",
              "eventName": "INSERT",
              "eventVersion": "1.1",
              "eventSource": "aws:dynamodb",
              "awsRegion": "<region>",
              "dynamodb": {
                "ApproximateCreationDateTime": "<approximate-creation-datetime>",
                "Keys": {
                  "id": {
                    "S": "test123"
                  }
                },
                "NewImage": {
                  "id": {
                    "S": "test123"
                  }
                },
                "SequenceNumber": "<sequence-number:1>",
                "SizeBytes": 18,
                "StreamViewType": "NEW_AND_OLD_IMAGES"
              },
              "eventSourceARN": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>"
            }
          ]
        }
      ],
      "lambda-multiple-log-events": [
        {
          "Records": [
            {
              "eventID": "<event-i-d:1>",
              "eventName": "INSERT",
              "eventVersion": "1.1",
              "eventSource": "aws:dynamodb",
              "awsRegion": "<region>",
              "dynamodb": {
                "ApproximateCreationDateTime": "<approximate-creation-datetime>",
                "Keys": {
                  "id": {
                    "S": "test123"
                  }
                },
                "NewImage": {
                  "id": {
                    "S": "test123"
                  }
                },
                "SequenceNumber": "<sequence-number:1>",
                "SizeBytes": 18,
                "StreamViewType": "NEW_AND_OLD_IMAGES"
              },
              "eventSourceARN": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>"
            }
          ]
        },
        {
          "Records": [
            {
              "eventID": "<event-i-d:2>",
              "eventName": "MODIFY",
              "eventVersion": "1.1",
              "eventSource": "aws:dynamodb",
              "awsRegion": "<region>",
              "dynamodb": {
                "ApproximateCreationDateTime": "<approximate-creation-datetime>",
                "Keys": {
                  "id": {
                    "S": "test123"
                  }
                },
                "NewImage": {
                  "id2": {
                    "S": "42test"
                  },
                  "id": {
                    "S": "test123"
                  }
                },
                "OldImage": {
                  "id": {
                    "S": "test123"
                  }
                },
                "SequenceNumber": "<sequence-number:2>",
                "SizeBytes": 36,
                "StreamViewType": "NEW_AND_OLD_IMAGES"
              },
              "eventSourceARN": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>"
            }
          ]
        }
      ]
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_dynamodb_event_filter[item_to_put12-item_to_put22-filter2-1]": {
    "recorded-date": "05-09-2022, 15:52:28",
    "recorded-content": {
      "table_creation_response": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "id",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "id",
              "KeyType": "HASH"
            }
          ],
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:1>",
          "TableSizeBytes": 0,
          "TableStatus": "CREATING"
        }
      },
      "create_event_source_mapping_response": {
        "BatchSize": 1,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>",
        "FilterCriteria": {
          "Filters": [
            {
              "Pattern": {
                "eventName": [
                  "INSERT"
                ],
                "eventSource": [
                  "aws:dynamodb"
                ]
              }
            }
          ]
        },
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": 1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "lambda-log-events": [
        {
          "Records": [
            {
              "eventID": "<event-i-d:1>",
              "eventName": "INSERT",
              "eventVersion": "1.1",
              "eventSource": "aws:dynamodb",
              "awsRegion": "<region>",
              "dynamodb": {
                "ApproximateCreationDateTime": "<approximate-creation-datetime>",
                "Keys": {
                  "id": {
                    "S": "test123"
                  }
                },
                "NewImage": {
                  "id": {
                    "S": "test123"
                  }
                },
                "SequenceNumber": "<sequence-number:1>",
                "SizeBytes": 18,
                "StreamViewType": "NEW_AND_OLD_IMAGES"
              },
              "eventSourceARN": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>"
            }
          ]
        }
      ],
      "lambda-multiple-log-events": [
        {
          "Records": [
            {
              "eventID": "<event-i-d:1>",
              "eventName": "INSERT",
              "eventVersion": "1.1",
              "eventSource": "aws:dynamodb",
              "awsRegion": "<region>",
              "dynamodb": {
                "ApproximateCreationDateTime": "<approximate-creation-datetime>",
                "Keys": {
                  "id": {
                    "S": "test123"
                  }
                },
                "NewImage": {
                  "id": {
                    "S": "test123"
                  }
                },
                "SequenceNumber": "<sequence-number:1>",
                "SizeBytes": 18,
                "StreamViewType": "NEW_AND_OLD_IMAGES"
              },
              "eventSourceARN": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>"
            }
          ]
        }
      ]
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_dynamodb_event_filter[item_to_put13-item_to_put23-filter3-1]": {
    "recorded-date": "05-09-2022, 15:53:29",
    "recorded-content": {
      "table_creation_response": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "id",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "id",
              "KeyType": "HASH"
            }
          ],
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:1>",
          "TableSizeBytes": 0,
          "TableStatus": "CREATING"
        }
      },
      "create_event_source_mapping_response": {
        "BatchSize": 1,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>",
        "FilterCriteria": {
          "Filters": [
            {
              "Pattern": {
                "dynamodb": {
                  "NewImage": {
                    "presentKey": [
                      {
                        "exists": false
                      }
                    ]
                  }
                }
              }
            }
          ]
        },
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": 1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "lambda-log-events": [
        {
          "Records": [
            {
              "eventID": "<event-i-d:1>",
              "eventName": "INSERT",
              "eventVersion": "1.1",
              "eventSource": "aws:dynamodb",
              "awsRegion": "<region>",
              "dynamodb": {
                "ApproximateCreationDateTime": "<approximate-creation-datetime>",
                "Keys": {
                  "id": {
                    "S": "test123"
                  }
                },
                "NewImage": {
                  "id": {
                    "S": "test123"
                  }
                },
                "SequenceNumber": "<sequence-number:1>",
                "SizeBytes": 18,
                "StreamViewType": "NEW_AND_OLD_IMAGES"
              },
              "eventSourceARN": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>"
            }
          ]
        }
      ],
      "lambda-multiple-log-events": [
        {
          "Records": [
            {
              "eventID": "<event-i-d:1>",
              "eventName": "INSERT",
              "eventVersion": "1.1",
              "eventSource": "aws:dynamodb",
              "awsRegion": "<region>",
              "dynamodb": {
                "ApproximateCreationDateTime": "<approximate-creation-datetime>",
                "Keys": {
                  "id": {
                    "S": "test123"
                  }
                },
                "NewImage": {
                  "id": {
                    "S": "test123"
                  }
                },
                "SequenceNumber": "<sequence-number:1>",
                "SizeBytes": 18,
                "StreamViewType": "NEW_AND_OLD_IMAGES"
              },
              "eventSourceARN": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>"
            }
          ]
        }
      ]
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_dynamodb_event_filter[item_to_put14-item_to_put24-filter4-0]": {
    "recorded-date": "05-09-2022, 15:53:48",
    "recorded-content": {
      "table_creation_response": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "id",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "id",
              "KeyType": "HASH"
            }
          ],
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:1>",
          "TableSizeBytes": 0,
          "TableStatus": "CREATING"
        }
      },
      "create_event_source_mapping_response": {
        "BatchSize": 1,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>",
        "FilterCriteria": {
          "Filters": [
            {
              "Pattern": {
                "dynamodb": {
                  "NewImage": {
                    "numericFilter": {
                      "N": [
                        {
                          "numeric": [
                            ">",
                            100
                          ]
                        }
                      ]
                    }
                  }
                }
              }
            }
          ]
        },
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": 1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "lambda-log-events": [],
      "lambda-multiple-log-events": []
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_dynamodb_event_filter[item_to_put15-item_to_put25-filter5-0]": {
    "recorded-date": "05-09-2022, 15:54:08",
    "recorded-content": {
      "table_creation_response": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "id",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "id",
              "KeyType": "HASH"
            }
          ],
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:1>",
          "TableSizeBytes": 0,
          "TableStatus": "CREATING"
        }
      },
      "create_event_source_mapping_response": {
        "BatchSize": 1,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>",
        "FilterCriteria": {
          "Filters": [
            {
              "Pattern": {
                "dynamodb": {
                  "NewImage": {
                    "numericFilter": {
                      "N": [
                        {
                          "numeric": [
                            ">=",
                            100,
                            "<",
                            200
                          ]
                        }
                      ]
                    }
                  }
                }
              }
            }
          ]
        },
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": 1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "lambda-log-events": [],
      "lambda-multiple-log-events": []
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_dynamodb_event_filter[item_to_put16-item_to_put26-filter6-1]": {
    "recorded-date": "05-09-2022, 15:55:30",
    "recorded-content": {
      "table_creation_response": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "id",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "id",
              "KeyType": "HASH"
            }
          ],
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:1>",
          "TableSizeBytes": 0,
          "TableStatus": "CREATING"
        }
      },
      "create_event_source_mapping_response": {
        "BatchSize": 1,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>",
        "FilterCriteria": {
          "Filters": [
            {
              "Pattern": {
                "dynamodb": {
                  "NewImage": {
                    "prefix": {
                      "S": [
                        {
                          "prefix": "us-1"
                        }
                      ]
                    }
                  }
                }
              }
            }
          ]
        },
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": 1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "lambda-log-events": [
        {
          "Records": [
            {
              "eventID": "<event-i-d:1>",
              "eventName": "INSERT",
              "eventVersion": "1.1",
              "eventSource": "aws:dynamodb",
              "awsRegion": "<region>",
              "dynamodb": {
                "ApproximateCreationDateTime": "<approximate-creation-datetime>",
                "Keys": {
                  "id": {
                    "S": "test123"
                  }
                },
                "NewImage": {
                  "prefix": {
                    "S": "us-1-testtest"
                  },
                  "id": {
                    "S": "test123"
                  }
                },
                "SequenceNumber": "<sequence-number:1>",
                "SizeBytes": 37,
                "StreamViewType": "NEW_AND_OLD_IMAGES"
              },
              "eventSourceARN": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>"
            }
          ]
        }
      ],
      "lambda-multiple-log-events": [
        {
          "Records": [
            {
              "eventID": "<event-i-d:1>",
              "eventName": "INSERT",
              "eventVersion": "1.1",
              "eventSource": "aws:dynamodb",
              "awsRegion": "<region>",
              "dynamodb": {
                "ApproximateCreationDateTime": "<approximate-creation-datetime>",
                "Keys": {
                  "id": {
                    "S": "test123"
                  }
                },
                "NewImage": {
                  "prefix": {
                    "S": "us-1-testtest"
                  },
                  "id": {
                    "S": "test123"
                  }
                },
                "SequenceNumber": "<sequence-number:1>",
                "SizeBytes": 37,
                "StreamViewType": "NEW_AND_OLD_IMAGES"
              },
              "eventSourceARN": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>"
            }
          ]
        }
      ]
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_dynamodb_invalid_event_filter[single-string]": {
    "recorded-date": "05-09-2022, 15:07:24",
    "recorded-content": {
      "exception_event_source_creation": {
        "Error": {
          "Code": "InvalidParameterValueException",
          "Message": "Invalid filter pattern definition."
        },
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 400
        },
        "Type": "User",
        "message": "Invalid filter pattern definition."
      }
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_dynamodb_invalid_event_filter[[{\"eventName\": [\"INSERT\"=123}]]": {
    "recorded-date": "05-09-2022, 15:07:34",
    "recorded-content": {
      "exception_event_source_creation": {
        "Error": {
          "Code": "InvalidParameterValueException",
          "Message": "Invalid filter pattern definition."
        },
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 400
        },
        "Type": "User",
        "message": "Invalid filter pattern definition."
      }
    }
  }
}
