{
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_dynamodb_event_source_mapping": {
    "recorded-date": "01-09-2022, 19:17:25",
    "recorded-content": {
      "create-table-result": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "my_partition_key",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "my_partition_key",
              "KeyType": "HASH"
            }
          ],
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:1>",
          "TableSizeBytes": 0,
          "TableStatus": "CREATING"
        }
      },
      "create_event_source_mapping_response": {
        "BatchSize": 1,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>",
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": 1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "event_logs": [
        {
          "Records": [
            {
              "eventID": "<event-i-d:1>",
              "eventName": "INSERT",
              "eventVersion": "1.1",
              "eventSource": "aws:dynamodb",
              "awsRegion": "<region>",
              "dynamodb": {
                "ApproximateCreationDateTime": "<approximate-creation-datetime>",
                "Keys": {
                  "my_partition_key": {
                    "S": "hello world"
                  }
                },
                "NewImage": {
                  "my_partition_key": {
                    "S": "hello world"
                  }
                },
                "SequenceNumber": "<sequence-number:1>",
                "SizeBytes": 54,
                "StreamViewType": "NEW_IMAGE"
              },
              "eventSourceARN": "arn:aws:dynamodb:<region>:111111111111:table/<resource:1>/stream/<resource:2>"
            }
          ]
        }
      ]
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_disabled_dynamodb_event_source_mapping": {
    "recorded-date": "01-09-2022, 19:31:30",
    "recorded-content": {
      "dynamodb_create_table_result": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "id",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "id",
              "KeyType": "HASH"
            }
          ],
          "LatestStreamArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
          "LatestStreamLabel": "<resource:1>",
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "StreamSpecification": {
            "StreamEnabled": true,
            "StreamViewType": "NEW_IMAGE"
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:2>",
          "TableSizeBytes": 0,
          "TableStatus": "CREATING"
        }
      },
      "create_event_source_mapping_result": {
        "BatchSize": 100,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": -1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "update_event_source_mapping_result": {
        "BatchSize": 100,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "OK",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": -1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Disabling",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      }
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_deletion_event_source_mapping_with_dynamodb": {
    "recorded-date": "01-09-2022, 20:16:04",
    "recorded-content": {
      "create_dynamodb_table_response": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "id",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "id",
              "KeyType": "HASH"
            }
          ],
          "LatestStreamArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
          "LatestStreamLabel": "<resource:1>",
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "StreamSpecification": {
            "StreamEnabled": true,
            "StreamViewType": "NEW_IMAGE"
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:2>",
          "TableSizeBytes": 0,
          "TableStatus": "CREATING"
        }
      },
      "create_event_source_mapping_result": {
        "BatchSize": 100,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {}
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 0,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": -1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "list_event_source_mapping_result": {
        "EventSourceMappings": [
          {
            "BatchSize": 100,
            "BisectBatchOnFunctionError": false,
            "DestinationConfig": {
              "OnFailure": {}
            },
            "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
            "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:3>",
            "FunctionResponseTypes": [],
            "LastModified": "datetime",
            "LastProcessingResult": "No records processed",
            "MaximumBatchingWindowInSeconds": 0,
            "MaximumRecordAgeInSeconds": -1,
            "MaximumRetryAttempts": -1,
            "ParallelizationFactor": 1,
            "StartingPosition": "TRIM_HORIZON",
            "State": "Enabled",
            "StateTransitionReason": "User action",
            "TumblingWindowInSeconds": 0,
            "UUID": "<uuid:2>"
          }
        ],
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        }
      }
    }
  },
  "tests/integration/awslambda/test_lambda_integration_dynamodbstreams.py::TestDynamoDBEventSourceMapping::test_dynamodb_event_source_mapping_with_on_failure_destination_config": {
    "recorded-date": "01-09-2022, 20:23:32",
    "recorded-content": {
      "update_table_response": {
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        },
        "TableDescription": {
          "AttributeDefinitions": [
            {
              "AttributeName": "my_partition_key",
              "AttributeType": "S"
            }
          ],
          "BillingModeSummary": {
            "BillingMode": "PAY_PER_REQUEST",
            "LastUpdateToPayPerRequestDateTime": "datetime"
          },
          "CreationDateTime": "datetime",
          "ItemCount": 0,
          "KeySchema": [
            {
              "AttributeName": "my_partition_key",
              "KeyType": "HASH"
            }
          ],
          "LatestStreamArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
          "LatestStreamLabel": "<resource:1>",
          "ProvisionedThroughput": {
            "NumberOfDecreasesToday": 0,
            "ReadCapacityUnits": 0,
            "WriteCapacityUnits": 0
          },
          "StreamSpecification": {
            "StreamEnabled": true,
            "StreamViewType": "NEW_IMAGE"
          },
          "TableArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>",
          "TableId": "<uuid:1>",
          "TableName": "<resource:2>",
          "TableSizeBytes": 0,
          "TableStatus": "UPDATING"
        }
      },
      "create_event_source_mapping_response": {
        "BatchSize": 1,
        "BisectBatchOnFunctionError": false,
        "DestinationConfig": {
          "OnFailure": {
            "Destination": "arn:aws:sqs:<region>:111111111111:<resource:3>"
          }
        },
        "EventSourceArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>",
        "FunctionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:4>",
        "FunctionResponseTypes": [],
        "LastModified": "datetime",
        "LastProcessingResult": "No records processed",
        "MaximumBatchingWindowInSeconds": 1,
        "MaximumRecordAgeInSeconds": -1,
        "MaximumRetryAttempts": 1,
        "ParallelizationFactor": 1,
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 202
        },
        "StartingPosition": "TRIM_HORIZON",
        "State": "Creating",
        "StateTransitionReason": "User action",
        "TumblingWindowInSeconds": 0,
        "UUID": "<uuid:2>"
      },
      "destination_queue_messages": {
        "Messages": [
          {
            "Body": {
              "requestContext": {
                "requestId": "<uuid:3>",
                "functionArn": "arn:aws:lambda:<region>:111111111111:function:<resource:4>",
                "condition": "RetryAttemptsExhausted",
                "approximateInvokeCount": 2
              },
              "responseContext": {
                "statusCode": 200,
                "executedVersion": "$LATEST",
                "functionError": "Unhandled"
              },
              "version": "1.0",
              "timestamp": "date",
              "DDBStreamBatchInfo": {
                "shardId": "shardId-00000001662056543178-3581973d",
                "startSequenceNumber": "700000000053046290230",
                "endSequenceNumber": "700000000053046290230",
                "approximateArrivalOfFirstRecord": "date",
                "approximateArrivalOfLastRecord": "date",
                "batchSize": 1,
                "streamArn": "arn:aws:dynamodb:<region>:111111111111:table/<resource:2>/stream/<resource:1>"
              }
            },
            "MD5OfBody": "1c97088b6b0a2fd1351add40a0864841",
            "MessageId": "<uuid:4>",
            "ReceiptHandle": "AQEB4+OOjLHOWIxNmRpVdrOkjwML48lHbR6QGHEfhRV326bx3rEm6I/Lag0Zyho82QrdUf8PfFCt/0ayrdwZjR+crPsO+x0INiC1A22EVp370WpzlIq317iCW1hhbIZDCqhfbSQoYVLWk1/7EFZeXbdroYsAijPlMi++ZCgVELyd3OjyxQbZUoaA1Cx55rQQMPuFEbbSDzjwpguijr8AAp3bDLWJ5WUvDhs5C/hZgQb2UOOpnj2he14zXMkVUDb4AyaXBCjbhEXYLvW2FEonT4uPzrkH/jcUr6r55qsky4GxYb9Xnc2QRrlpR4EK4Q39kh7a+cSBd2PKQ5vnpBjNeg9fuuOw6jKbFFXeAi8J3cxkMtBccoF6k2KDNeQSaqmQ9ZP99YHK6wCLOzrMtX4ibjTy4A=="
          }
        ],
        "ResponseMetadata": {
          "HTTPHeaders": {},
          "HTTPStatusCode": 200
        }
      }
    }
  }
}
